---
import customElements from '@maxhill/components/custom-elements.json';
import { marked } from 'marked';

const components = customElements.modules
  .flatMap(module => module.declarations || [])
  .filter(decl => decl.customElement === true);
---

<div class="component-list">
  {components.map(component => (
    <section class="component">
      <h3>&lt;{component.tagName || component.name}&gt;</h3>
      {component.description && <div set:html={marked.parse(component.description)} />}
      
      {component.attributes && component.attributes.length > 0 && (
        <div class="attributes">
          <h4>Attributes</h4>
          <dl>
            {component.attributes.map(attr => (
              <>
                <dt>
                  <code>{attr.name}</code>
                  {attr.type && <span class="type">: {attr.type.text}</span>}
                </dt>
                {attr.description && <dd>{attr.description}</dd>}
              </>
            ))}
          </dl>
        </div>
      )}
      
      {component.slots && component.slots.length > 0 && (
        <div class="slots">
          <h4>Slots</h4>
          <dl>
            {component.slots.map(slot => (
              <>
                <dt><code>{slot.name || '(default)'}</code></dt>
                {slot.description && <dd>{slot.description}</dd>}
              </>
            ))}
          </dl>
        </div>
      )}
      
      {component.events && component.events.length > 0 && (
        <div class="events">
          <h4>Events</h4>
          <dl>
            {component.events.map(event => (
              <>
                <dt>
                  <code>{event.name}</code>
                  {event.type && <span class="type">: {event.type.text}</span>}
                </dt>
                {event.description && <dd>{event.description}</dd>}
              </>
            ))}
          </dl>
        </div>
      )}
      
      {component.examples && component.examples.length > 0 && (
        <div class="examples">
          <h4>Examples</h4>
          {component.examples.map(example => (
            <div class="example">
              {example.description && <h5>{example.description}</h5>}
              <pre><code>{example.value}</code></pre>
            </div>
          ))}
        </div>
      )}
    </section>
  ))}
</div>

<style>
  .component-list {
    display: flex;
    flex-direction: column;
    gap: var(--size-6);
  }
  
  .component {
    border: var(--border);
    border-radius: var(--radius-2);
    padding: var(--size-4);
    background-color: var(--color-surface);
  }
  
  .component h3 {
    margin: 0 0 var(--size-2) 0;
    color: var(--color-text-loud);
    font-family: var(--font-mono);
    font-size: var(--font-size-4);
  }
  
  .component > p {
    margin: 0 0 var(--size-4) 0;
    color: var(--color-text);
  }
  
  .attributes, .slots, .events {
    margin-top: var(--size-4);
  }
  
  h4 {
    margin: 0 0 var(--size-2) 0;
    font-size: var(--font-size-2);
    color: var(--color-text-loud);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }
  
  dl {
    margin: 0;
    display: grid;
    grid-template-columns: auto 1fr;
    gap: var(--size-2) var(--size-4);
    align-items: baseline;
  }
  
  dt {
    display: flex;
    align-items: baseline;
    gap: var(--size-2);
  }
  
  dd {
    margin: 0;
    color: var(--color-text-soft);
    font-size: var(--font-size-1);
  }
  
  code {
    font-family: var(--font-mono);
    background-color: var(--color-surface-raised);
    padding: var(--size-1) var(--size-2);
    border-radius: var(--radius-1);
    font-size: var(--font-size-1);
    width: fit-content;
  }
  
  .type {
    font-family: var(--font-mono);
    color: var(--color-text-soft);
    font-size: var(--font-size-1);
  }
</style>
